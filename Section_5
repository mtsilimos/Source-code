import pandas as pd
import numpy as np
from sklearn.feature_extraction.text import TfidfTransformer
from sklearn.feature_extraction.text import CountVectorizer

corpus = ['The cats eat fish',
'Leo catches fish every day',
'Once a day I eat fish'
]

# CountVectorizer
cv=CountVectorizer()
word_count_vector=cv.fit_transform(corpus)
tokens = cv.get_feature_names_out()
print(word_count_vector.shape) 
print(tokens)
print(len(tokens))
print(word_count_vector.toarray())


df = pd.DataFrame(word_count_vector.toarray(), columns=tokens)
df

# TF
from sklearn.feature_extraction.text import TfidfVectorizer
tfidf_vectorizer = TfidfVectorizer(use_idf=False, norm='l1')
X = tfidf_vectorizer.fit_transform(corpus)
df = pd.DataFrame(X.toarray(),
columns=tfidf_vectorizer.get_feature_names_out())
df


# IDF
tfidf_transformer=TfidfTransformer(smooth_idf=True,use_idf=True)
tfidf_transformer.fit(word_count_vector)

df_idf = pd.DataFrame(tfidf_transformer.idf_, index=tokens,columns=["idf_weights"])
df_idf

# TF-IDF
import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer

corpus = ['The cats eat fish',
'Leo catches fish every day',
'Once a day I eat fish'
]


vec = TfidfVectorizer()
tf_idf =  vec.fit_transform(corpus)
print(pd.DataFrame(tf_idf.toarray(), columns=vec.get_feature_names_out()))


# Cosine Similarity between two TF-IDF vectors

import pandas as pd
from sklearn.feature_extraction.text import TfidfVectorizer

corpus = ['The President communicates nicely with all his colleagues',
'The President has a very close relationship with the staff']


vec = TfidfVectorizer()
tf_idf =  vec.fit_transform(corpus)
print(pd.DataFrame(tf_idf.toarray(), columns=vec.get_feature_names_out()))

from sklearn.metrics.pairwise import cosine_similarity
cosine_sim = cosine_similarity(tf_idf, tf_idf)
print(cosine_sim)

import plotly.express as px
z = [[1,         0.27975559],
 [0.27975559, 1        ]]

fig = px.imshow(z, text_auto=True, labels=dict(x="Cosine similarity", y="Text", color="Productivity"),
                x=['text1', 'text2'],
                y=['text1', 'text2'])
fig.show()


# Homework

# Task 1a)
# Apply text preprocessing (noise removal & normalisation) techniques in the following text.
# Task 1b)
# Calculate the TF-IDF values.

text1 = '''So many people will be trying to leave at the same time, there will not be flights, the roads will be blocked, are you going to be able to get fuel for your car, your
passport, is there going to be cash in the banking machines?'''
text2 = '''Now some people have arrived, but they need to provide proof of his British citizenship to get an emergency travel document, a more urgent alternative to a
passport.'''
text3 = '''If we take the advice at face value, it means the UK and also the US government are worried that Russian action is imminent - that makes everybody want to take
their passport and get out.'''


# Task 2
# Calculate and plot the cosine similarity between text1, text2, text3 and text4.

text1 = 'The President communicates nicely with all his colleagues'
text2 = 'The President has a very close relationship with the staff'
text3 = 'The President does not want to have a meeting with the colleagues'
text4 = 'She would like to see the President'
